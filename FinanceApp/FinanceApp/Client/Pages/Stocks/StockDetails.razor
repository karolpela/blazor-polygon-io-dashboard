@using FinanceApp.Shared.Models.TickerDetails
@using FinanceApp.Shared.Models.Tickers
@inject IHttpClientFactory ClientFactory

<MudItem Class="mt-4">
    @if (tickerDetails != null)
    {
        <StockOpenClose SelectedTicker="@SelectedTicker"> </StockOpenClose>
    }
</MudItem>

@code {
    [Parameter]
    public Result? SelectedTicker { get; set; }

    private TickerDetails? tickerDetails;

    protected override async Task OnParametersSetAsync()
    {
        if (SelectedTicker != null)
        {
            try
            {
                var client = ClientFactory.CreateClient();
                tickerDetails = await client.GetFromJsonAsync<TickerDetails>($"api/tickers/{SelectedTicker.Ticker}");
            }
            catch (HttpRequestException ex)
            {
                Console.WriteLine(ex.Message);
            }
        }
    }
}
